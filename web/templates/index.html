{% extends "layout.html" %}
{% block body %}
<script src="http://code.jquery.com/jquery-1.8.2.min.js"></script>
    <script src="{{ url_for('static', filename='sockets.js') }}"></script>
<div id='main'>
    <div class="hero-unit">
        <h1>Chaos!</h1>
        <p>Oh, cool! Let's fight with mess and be excellent to each other!</p>
        <a href="https://wiki.hackerspace.pl/projects:hs-chaos" class="btn btn-success">Learn more!</a>
    </div>
    <h2>Available devices</h2>
<div class="media">
    <a class="pull-left" href="#">
        <img class="media-object" src='http://placekitten.com/100/100'/>
    </a>
    <div class="media-body">
        <h4 class="media-heading">Camera 1</h4>
        <p>Camera placed in the first room</p>
    </div>
</div>

    <hr />
    <h2>Camera 1</h2>

    <img class="media-object" src="{{ url_for('static', filename=path)}}"/>

    <h2>Camera one tables - basic info</h2>

    <h4>Tables' status
        <a href="{{url_for('index')}}" class="btn btn-warning btn-large">Reload</a>
    </h4>
    {% for table in tables %}
        <div class="row-fluid">
            <div class="well-large span8">

                <div class="media">
                    <a class="pull-left" href="#">
                        <img class="media-object" src='http://placekitten.com/120/180'/>
                    </a>
                    <div class="media-body">
                    <h4 class="media-heading">Table {{table.id}}</h4>

                    {% if table.message %}
                    <div class="alert alert-error">
                        {{ table.message }}
                    </div>
                    {% endif %}
                    <p>
                    {% if table.occupied %}
                        Occupied by: {{ table.actions[0].user_id }}
                    {% else %}
                        Table is free.
                    {% endif %}
                    </p>
                    <p>
                        chaos percentage:
                    </p>
                    <div class="progress progress-warning progress-striped">
                    <div class="bar" style="width: {{table.chaos_percentage}}%"></div>
                    </div>


                    </div>
                </div>
            </div>
            <div class="well-large span4">
                <h4>Last actions</h4>
                {% for action in table.actions %}
                    <p>At {{ action.created.ctime()}} {{ action.user_id }} {{action.action}}ed table
                    {%if action.action == 'claim' %} for {{ action.how_long}}{% endif %} </p>

                {% endfor %}

            </div>
        </div>

    {% endfor %}

    {% if session.logged_in %}
    <h2>Camera one tables - management</h2>
    <p>
        What's it all about?
    </p>
    <div class="well-large">
    <form class='table_form form-horizontal'
        action="{{ url_for('index') }}" method=post>

        <select id='table_id' name='table_id'>
            {% for table in tables %}
                <option value={{table.id}}>Table: {{table.id}}</option>
            {% endfor %}
        </select>
        <select id='action' name='action'>
            <option value="claim">Claim</option>
            <option value="free">Free</option>
        </select>
        <input type="submit" value="Ok" class="btn btn-success">
    </form>
    </div>

</div>
    {% else %}
    <p>

                                  <a class="action login" href="{{ url_for('login') }}">Log in</a>
    to manage tables and see your history.
    </p>
    {% endif %}
<div id='comunication'>
    <p id="log"></p>
</div>


{% endblock %}

